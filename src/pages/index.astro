---

import Layout from "../layouts/Layout.astro"

import CaseStudiesSection from "../components/CaseStudiesSection.astro"
import ClientsSection from "../components/ClientsSection.astro"
import FaqSection from "../components/FaqSection.astro"
import ServicesCarousel from "../components/ServicesCarousel.astro"
import HeroSection from "../components/HeroSection.astro"
import LatestPostsSection from "../components/LatestPostsSection.astro"
import NewsletterSection from "../components/NewsletterSection.astro"
import PricingSection from "../components/PricingSection.astro"
import QuoteSection from "../components/QuoteSection.astro"
import TestimonialsSection from "../components/TestimonialsSection.astro"

import { getLangFromUrl } from '../i18n/ui';

// Import existing JSON data
import caseStudies from "../data/case_studies.json"
import clients from "../data/clients.json"
import faq from "../data/faq.json"
import services from "../data/services.json"
import pricing from "../data/pricing.json"
import testimonials from "../data/testimonials.json"
import home from "../data/home.json"
import global_settings from "../data/global_settings.json"
import newsletter from "../data/newsletter.json"

// Load content based on language
const lang = getLangFromUrl(Astro.url);

// Try to load i18n content, fallback to original
let i18nContent;
try {
  i18nContent = await import(`../i18n/content/${lang}.json`);
} catch (error) {
  console.warn(`Could not load i18n content for ${lang}, using fallback`);
}

// Use i18n content if available, otherwise use original
const homeContent = i18nContent?.default?.home || home;
const globalSettings = i18nContent?.default?.global_settings || global_settings;
const newsletterContent = i18nContent?.default?.newsletter || newsletter;

---

<Layout title={ globalSettings.title }>

  <HeroSection
    content={ homeContent.hero_content }
    settings={ globalSettings }
    title={ homeContent.hero_title }
  />

  <ServicesCarousel
    services={ services }
    title={ homeContent.services_title }
  />

  <ClientsSection
    clients={ clients }
    title={ homeContent.clients_title }
  />

  <QuoteSection
    cite={ homeContent.quote_cite }
    content={ homeContent.quote_content }
    image={ homeContent.quote_image }
    role={ homeContent.quote_role }
  />

  <CaseStudiesSection
    caseStudies={ caseStudies }
    title={ homeContent.case_studies_title }
  />

  <TestimonialsSection
    testimonials={ testimonials }
    title={ homeContent.testimonials_title }
  />

  <LatestPostsSection />

  <PricingSection
    pricing={ pricing }
    title={ homeContent.pricing_title }
  />

  <FaqSection
    faq={ faq }
    title={ homeContent.faq_title }
  />

  <NewsletterSection newsletter={newsletterContent} />

</Layout>
